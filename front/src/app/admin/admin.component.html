<!-- Fix me : group by job then country -->

<p-table *ngIf="users" [value]="users">
  <ng-template pTemplate="header">
    <tr>
      <th>
        <button 
          [ngClass]="{'p-button-success': setJob, 'p-button-danger': !setJob}" 
          icon="pi {{setJob ? 'pi-chevron-down' : 'pi-chevron-up'}}"
          iconPos="right" 
          pButton 
          (click)="onJob()" 
          label="Job">
        </button>
      </th>
      <th>
        <button 
          [ngClass]="{'p-button-success': setCountry, 'p-button-danger': !setCountry}" 
          icon="pi {{setCountry ? 'pi-chevron-down' : 'pi-chevron-up'}}" 
          iconPos="right"
          pButton 
          (click)="onCountry()" 
          label="Country">
        </button>
      </th>
      <th>ID</th>
      <th>Firstname</th>
      <th>Lastname</th>
      <th>Age</th>
      <th>State</th>
      <th>Action</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowIndex="rowIndex" let-user>
    <tr>
      <td *ngIf="rowGroupMetaJob[user.earthJob] && rowGroupMetaJob[user.earthJob].index === rowIndex" 
          [attr.rowspan]="rowGroupMetaJob[user.earthJob] && rowGroupMetaJob[user.earthJob].size">
        <span class="p-text-bold p-ml-2">{{user.earthJob}}</span>
      </td>
      <td *ngIf="rowGroupMetaCountry[user.earthCountry] && rowGroupMetaCountry[user.earthCountry].index === rowIndex" 
          [attr.rowspan]="rowGroupMetaCountry[user.earthCountry] && rowGroupMetaCountry[user.earthCountry].size">
        <span class="p-text-bold p-ml-2">{{user.earthCountry}}</span>
      </td>
      <td>{{user.id}}</td>
      <td>{{user.firstname}}</td>
      <td>{{user.lastname}}</td>
      <td>{{dateOfBirthday(user) | date: 'shortDate' }}</td>
      <td>{{user.state}}</td>
      <td>
        <p-button 
          label="Approuved" 
          [disabled]="user.state==unapprovedState" 
          (click)="onApprouved(user.state, user.id)">
        </p-button></td>
    </tr>
  </ng-template>
</p-table>
